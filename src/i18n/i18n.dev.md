# 国际化开发指南 (i18n Development Guide)

## 概述

本项目使用自定义的国际化系统，支持三种语言：德语(de)、英语(en)、中文(zh)。目前已实现基础的翻译系统，但仍有部分页面需要完成国际化改造。

## 当前状态

### ✅ 已完成国际化的组件/页面
- `src/app/[locale]/page.tsx` - 首页 (完全国际化)
- `src/components/Header.tsx` - 导航栏组件 (完全国际化)
- `src/components/LanguageSwitcher.tsx` - 语言切换器 (功能性组件)

### ⚠️ 需要国际化的组件/页面
- `src/components/forms/QuickMatchForm.tsx` - 快速匹配表单
- `src/app/[locale]/matching-results/page.tsx` - 匹配结果页面
- `src/app/[locale]/jobs/page.tsx` - 职位列表页面
- `src/app/[locale]/profile/page.tsx` - 个人资料页面
- `src/app/[locale]/quick-match/page.tsx` - 快速匹配页面
- `src/app/[locale]/update-profile/page.tsx` - 更新资料页面
- `src/components/ProfileCompletionBanner.tsx` - 资料完成横幅
- `src/components/JobCard.tsx` - 职位卡片组件

## 技术架构

### 1. 翻译系统结构

```typescript
// src/i18n/translations.ts
export interface Translations {
  hero: { title: string; subtitle: string; ... }
  categories: { title: string; cleaning: { title: string; ... } }
  // ... 更多翻译接口
}

export const translations: Record<string, Translations> = {
  de: { /* 德语翻译 */ },
  en: { /* 英语翻译 */ },
  zh: { /* 中文翻译 */ }
}

export function getTranslations(locale: string): Translations
```

### 2. 路由系统

- 使用 Next.js App Router 的 `[locale]` 动态路由
- 支持路径：`/de`, `/en`, `/zh`
- 中间件处理根路径重定向到默认语言 `/de`

### 3. 语言切换

- `LanguageSwitcher` 组件处理语言切换逻辑
- 使用 cookies 记住用户语言偏好
- 自动保持当前页面路径切换语言

## 开发指南

### 快速入门 (Step-by-Step)

#### 步骤 1: 为新页面添加翻译

1. 在 `src/i18n/translations.ts` 中添加新的翻译接口：

```typescript
export interface Translations {
  // 现有翻译...
  newPage: {
    title: string
    button: string
    // ... 添加所需的翻译键
  }
}
```

2. 为每种语言添加翻译内容：

```typescript
export const translations: Record<string, Translations> = {
  de: {
    // 现有翻译...
    newPage: {
      title: "德语标题",
      button: "德语按钮"
    }
  },
  en: {
    // 现有翻译...
    newPage: {
      title: "English Title",
      button: "English Button"
    }
  },
  zh: {
    // 现有翻译...
    newPage: {
      title: "中文标题",
      button: "中文按钮"
    }
  }
}
```

#### 步骤 2: 在页面组件中使用翻译

```typescript
// 服务端组件 (页面)
import { getTranslations } from "@/i18n/translations"

export default async function NewPage({ params }: { params: Promise<{ locale: string }> }) {
  const { locale } = await params;
  const t = getTranslations(locale);
  
  return (
    <div>
      <h1>{t.newPage.title}</h1>
      <button>{t.newPage.button}</button>
    </div>
  );
}

// 客户端组件
'use client'
import { useParams } from 'next/navigation'
import { getTranslations } from '@/i18n/translations'

export function NewComponent() {
  const params = useParams();
  const locale = params?.locale as string || 'de';
  const t = getTranslations(locale);
  
  return <h1>{t.newPage.title}</h1>;
}
```

#### 步骤 3: 处理链接和导航

确保所有内部链接包含 locale 参数：

```typescript
// ✅ 正确
<Link href={`/${locale}/jobs`}>Jobs</Link>

// ❌ 错误
<Link href="/jobs">Jobs</Link>
```

### 待完成的国际化任务

#### 高优先级任务

1. **QuickMatchForm 组件国际化**
   - 需要翻译：表单标题、字段标签、选项文字、按钮文字
   - 文件：`src/components/forms/QuickMatchForm.tsx`
   - 硬编码文字：60+ 个德语字符串

2. **匹配结果页面国际化**
   - 需要翻译：加载提示、成功消息、统计标签、按钮文字
   - 文件：`src/app/[locale]/matching-results/page.tsx`
   - 硬编码文字：25+ 个德语字符串

3. **更新资料页面国际化**
   - 需要翻译：表单字段、选项、提示文字
   - 文件：`src/app/[locale]/update-profile/page.tsx`
   - 硬编码文字：100+ 个中文字符串

#### 中等优先级任务

4. **职位列表页面国际化**
   - 文件：`src/app/[locale]/jobs/page.tsx`
   - 硬编码文字：10+ 个德语字符串

5. **快速匹配页面国际化**
   - 文件：`src/app/[locale]/quick-match/page.tsx`
   - 硬编码文字：10+ 个德语字符串

6. **个人资料页面国际化**
   - 文件：`src/app/[locale]/profile/page.tsx`
   - 硬编码文字：10+ 个英语字符串

#### 低优先级任务

7. **组件国际化**
   - `src/components/ProfileCompletionBanner.tsx`
   - `src/components/JobCard.tsx`

## 开发规范

### 1. 翻译键命名规范

- 使用驼峰命名法：`heroTitle`, `submitButton`
- 按功能模块分组：`hero.title`, `form.submitButton`
- 描述性命名，避免简写：`navigationMenu` 而不是 `navMenu`

### 2. 翻译内容规范

- **德语**：作为默认语言，翻译要准确、正式
- **英语**：使用美式英语，简洁明了
- **中文**：使用简体中文，符合中国用户习惯

### 3. 代码规范

- 服务端组件使用 `await params` 获取 locale
- 客户端组件使用 `useParams()` 获取 locale
- 始终提供 fallback 语言：`locale || 'de'`
- Mock 数据不需要国际化，但 UI 文字需要

### 4. 测试规范

测试语言切换功能：
1. 访问 `http://localhost:3000/de`
2. 使用语言切换器切换到英语/中文
3. 验证 URL 变更：`/en` 或 `/zh`
4. 验证页面内容语言变更
5. 验证导航链接正确包含 locale

## 常见问题

### Q: 如何处理复杂的文本插值？

```typescript
// translations.ts
welcomeMessage: "欢迎 {name}，您有 {count} 个新消息"

// 组件中
const message = t.welcomeMessage
  .replace('{name}', userName)
  .replace('{count}', messageCount.toString())
```

### Q: 如何处理复数形式？

```typescript
// translations.ts
jobCount: {
  zero: "没有工作",
  one: "{count} 个工作", 
  other: "{count} 个工作"
}

// 建议创建辅助函数处理复数
function pluralize(count: number, translations: any) {
  if (count === 0) return translations.zero
  if (count === 1) return translations.one
  return translations.other.replace('{count}', count)
}
```

### Q: Mock 数据是否需要国际化？

Mock 数据（如职位信息、用户信息）保持原样，不需要国际化。只有 UI 界面文字需要国际化。

### Q: 如何确保新增的翻译完整性？

在添加新翻译时，确保在 `de`、`en`、`zh` 三种语言中都添加对应的翻译内容，避免遗漏。

## 下一步计划

1. **第一阶段**：完成核心用户流程的国际化（QuickMatchForm + 匹配结果页面）
2. **第二阶段**：完成所有页面的国际化
3. **第三阶段**：优化翻译质量，添加更多语言支持
4. **第四阶段**：考虑使用 next-intl 等成熟的国际化框架

## 相关文件

- `/src/i18n/translations.ts` - 翻译定义文件
- `/middleware.ts` - 路由中间件，处理语言重定向
- `/src/components/LanguageSwitcher.tsx` - 语言切换组件
- `/src/app/[locale]/layout.tsx` - 语言布局组件
- `/src/app/page.tsx` - 根路径重定向